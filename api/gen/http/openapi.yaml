swagger: "2.0"
info:
    title: pgEdge Control Plane API
    description: Service for creating, modifying, and operating pgEdge databases.
    version: 0.0.1
host: localhost:3000
consumes:
    - application/json
    - application/xml
    - application/gob
produces:
    - application/json
    - application/xml
    - application/gob
paths:
    /cluster:
        get:
            tags:
                - control-plane
            summary: inspect-cluster control-plane
            description: Returns information about the cluster.
            operationId: control-plane#inspect-cluster
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/Cluster'
                        required:
                            - id
                            - tenant_id
                            - status
                            - hosts
            schemes:
                - http
    /databases:
        get:
            tags:
                - control-plane
            summary: list-databases control-plane
            description: Lists all databases in the cluster.
            operationId: control-plane#list-databases
            responses:
                "200":
                    description: OK response.
                    schema:
                        type: array
                        items:
                            $ref: '#/definitions/Database'
            schemes:
                - http
        post:
            tags:
                - control-plane
            summary: create-database control-plane
            description: Creates a new database in the cluster.
            operationId: control-plane#create-database
            parameters:
                - name: Create-DatabaseRequestBody
                  in: body
                  required: true
                  schema:
                    $ref: '#/definitions/CreateDatabaseRequest'
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/Database'
                        required:
                            - id
                            - status
                            - instances
            schemes:
                - http
    /databases/{database_id}:
        get:
            tags:
                - control-plane
            summary: inspect-database control-plane
            description: Returns information about a particular database in the cluster.
            operationId: control-plane#inspect-database
            parameters:
                - name: database_id
                  in: path
                  description: ID of the database to inspect.
                  required: true
                  type: string
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/Database'
                        required:
                            - id
                            - status
                            - instances
            schemes:
                - http
        post:
            tags:
                - control-plane
            summary: update-database control-plane
            description: Updates a database with the given specification.
            operationId: control-plane#update-database
            parameters:
                - name: database_id
                  in: path
                  description: ID of the database to update.
                  required: true
                  type: string
                - name: Update-DatabaseRequestBody
                  in: body
                  required: true
                  schema:
                    $ref: '#/definitions/UpdateDatabaseRequest'
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/Database'
                        required:
                            - id
                            - status
                            - instances
            schemes:
                - http
        delete:
            tags:
                - control-plane
            summary: delete-database control-plane
            description: Deletes a database from the cluster.
            operationId: control-plane#delete-database
            parameters:
                - name: database_id
                  in: path
                  description: ID of the database to delete.
                  required: true
                  type: string
            responses:
                "204":
                    description: No Content response.
            schemes:
                - http
    /hosts:
        get:
            tags:
                - control-plane
            summary: list-hosts control-plane
            description: Lists all hosts within the cluster.
            operationId: control-plane#list-hosts
            responses:
                "200":
                    description: OK response.
                    schema:
                        type: array
                        items:
                            $ref: '#/definitions/Host'
            schemes:
                - http
    /hosts/{host_id}:
        get:
            tags:
                - control-plane
            summary: inspect-host control-plane
            description: Returns information about a particular host in the cluster.
            operationId: control-plane#inspect-host
            parameters:
                - name: host_id
                  in: path
                  description: ID of the host to inspect.
                  required: true
                  type: string
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/Host'
                        required:
                            - id
                            - status
                            - hostname
                            - ipv4_address
            schemes:
                - http
        delete:
            tags:
                - control-plane
            summary: remove-host control-plane
            description: Removes a host from the cluster.
            operationId: control-plane#remove-host
            parameters:
                - name: host_id
                  in: path
                  description: ID of the host to remove.
                  required: true
                  type: string
            responses:
                "204":
                    description: No Content response.
            schemes:
                - http
    /openapi.json:
        get:
            tags:
                - control-plane
            summary: Download ./gen/http/openapi.json
            operationId: control-plane#/openapi.json
            responses:
                "200":
                    description: File downloaded
                    schema:
                        type: file
            schemes:
                - http
definitions:
    BackupConfigSpec:
        title: BackupConfigSpec
        type: object
        properties:
            id:
                type: string
                description: The unique identifier for this backup configuration.
                example: default
            node_names:
                type: array
                items:
                    type: string
                    example: Labore in.
                description: The names of the nodes where this backup configuration should be applied. The configuration will apply to all nodes when this field is empty or unspecified.
                example:
                    - n1
                    - n3
            provider:
                type: string
                description: The backup provider for this backup configuration.
                example: pgbackrest
                enum:
                    - pgbackrest
                    - pg_dump
            repositories:
                type: array
                items:
                    $ref: '#/definitions/BackupRepositorySpec'
                description: The repositories for this backup configuration.
                example:
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
            schedules:
                type: array
                items:
                    $ref: '#/definitions/BackupScheduleSpec'
                description: The schedules for this backup configuration.
                example:
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
        example:
            id: default
            node_names:
                - n1
                - n3
            provider: pgbackrest
            repositories:
                - azure_account: pgedge-backups
                  azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  azure_endpoint: blob.core.usgovcloudapi.net
                  base_path: /backups
                  gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  gcs_endpoint: localhost
                  id: f6b84a99-5e91-4203-be1e-131fe82e5984
                  retention_full: 2
                  retention_full_type: count
                  s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  s3_endpoint: s3.us-east-1.amazonaws.com
                  s3_region: us-east-1
                  type: s3
                - azure_account: pgedge-backups
                  azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  azure_endpoint: blob.core.usgovcloudapi.net
                  base_path: /backups
                  gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  gcs_endpoint: localhost
                  id: f6b84a99-5e91-4203-be1e-131fe82e5984
                  retention_full: 2
                  retention_full_type: count
                  s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                  s3_endpoint: s3.us-east-1.amazonaws.com
                  s3_region: us-east-1
                  type: s3
            schedules:
                - cron_expression: 0 6 * * ?
                  id: daily-full-backup
                  type: full
                - cron_expression: 0 6 * * ?
                  id: daily-full-backup
                  type: full
                - cron_expression: 0 6 * * ?
                  id: daily-full-backup
                  type: full
        required:
            - id
            - provider
    BackupRepositorySpec:
        title: BackupRepositorySpec
        type: object
        properties:
            azure_account:
                type: string
                description: The Azure account name for this repository. Only applies when type = 'azure'.
                example: pgedge-backups
            azure_container:
                type: string
                description: The Azure container name for this repository. Only applies when type = 'azure'.
                example: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            azure_endpoint:
                type: string
                description: The optional Azure endpoint for this repository. Only applies when type = 'azure'.
                example: blob.core.usgovcloudapi.net
            base_path:
                type: string
                description: The base path within the repository to store backups.
                example: /backups
            gcs_bucket:
                type: string
                description: The GCS bucket name for this repository. Only applies when type = 'gcs'.
                example: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            gcs_endpoint:
                type: string
                description: The optional GCS endpoint for this repository. Only applies when type = 'gcs'.
                example: localhost
            id:
                type: string
                description: The unique identifier of this repository.
                example: f6b84a99-5e91-4203-be1e-131fe82e5984
            retention_full:
                type: integer
                description: The count of full backups to retain or the time to retain full backups.
                example: 2
                format: int64
            retention_full_type:
                type: string
                description: The type of measure used for retention_full.
                example: count
                enum:
                    - time
                    - count
            s3_bucket:
                type: string
                description: The S3 bucket name for this repository. Only applies when type = 's3'.
                example: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            s3_endpoint:
                type: string
                description: The optional S3 endpoint for this repository. Only applies when type = 's3'.
                example: s3.us-east-1.amazonaws.com
            s3_region:
                type: string
                description: The region of the S3 bucket for this repository. Only applies when type = 's3'.
                example: us-east-1
            type:
                type: string
                description: The type of this repository.
                example: s3
                enum:
                    - s3
                    - gcs
                    - azure
        example:
            azure_account: pgedge-backups
            azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            azure_endpoint: blob.core.usgovcloudapi.net
            base_path: /backups
            gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            gcs_endpoint: localhost
            id: f6b84a99-5e91-4203-be1e-131fe82e5984
            retention_full: 2
            retention_full_type: count
            s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
            s3_endpoint: s3.us-east-1.amazonaws.com
            s3_region: us-east-1
            type: s3
        required:
            - type
    BackupScheduleSpec:
        title: BackupScheduleSpec
        type: object
        properties:
            cron_expression:
                type: string
                description: The cron expression for this schedule.
                example: 0 6 * * ?
            id:
                type: string
                description: The unique identifier for this backup schedule.
                example: daily-full-backup
            type:
                type: string
                description: The type of backup to take on this schedule.
                example: full
                enum:
                    - full
                    - incr
        example:
            cron_expression: 0 6 * * ?
            id: daily-full-backup
            type: full
        required:
            - id
            - type
            - cron_expression
    Cluster:
        title: Cluster
        type: object
        properties:
            hosts:
                type: array
                items:
                    $ref: '#/definitions/Host'
                description: All of the hosts in the cluster.
                example:
                    - cohort: pps1n11hqijn9rbee4cjil453
                      config:
                        traefik_enabled: true
                        vector_enabled: true
                      hostname: i-0123456789abcdef.ec2.internal
                      id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      ipv4_address: 10.24.34.0
                      status:
                        state: available
                      type: systemd
                    - cohort: pps1n11hqijn9rbee4cjil453
                      config:
                        traefik_enabled: true
                        vector_enabled: true
                      hostname: i-0123456789abcdef.ec2.internal
                      id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      ipv4_address: 10.24.34.0
                      status:
                        state: available
                      type: systemd
            id:
                type: string
                description: Unique identifier for the cluster.
                example: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            status:
                $ref: '#/definitions/ClusterStatus'
            tenant_id:
                type: string
                description: Unique identifier for the cluster's owner.
                example: 8210ec10-2dca-406c-ac4a-0661d2189954
        example:
            hosts:
                - cohort: pps1n11hqijn9rbee4cjil453
                  config:
                    traefik_enabled: true
                    vector_enabled: true
                  hostname: i-0123456789abcdef.ec2.internal
                  id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  ipv4_address: 10.24.34.0
                  status:
                    state: available
                  type: systemd
                - cohort: pps1n11hqijn9rbee4cjil453
                  config:
                    traefik_enabled: true
                    vector_enabled: true
                  hostname: i-0123456789abcdef.ec2.internal
                  id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  ipv4_address: 10.24.34.0
                  status:
                    state: available
                  type: systemd
            id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            status:
                state: available
            tenant_id: 8210ec10-2dca-406c-ac4a-0661d2189954
        required:
            - id
            - tenant_id
            - status
            - hosts
    ClusterStatus:
        title: ClusterStatus
        type: object
        properties:
            state:
                type: string
                description: The current state of the cluster.
                example: error
                enum:
                    - available
                    - error
        example:
            state: error
        required:
            - state
    CreateDatabaseRequest:
        title: CreateDatabaseRequest
        type: object
        properties:
            id:
                type: string
                description: Unique identifier for the database.
                example: 02f1a7db-fca8-4521-b57a-2a375c1ced51
            spec:
                $ref: '#/definitions/DatabaseSpec'
            tenant_id:
                type: string
                description: Unique identifier for the databases's owner.
                example: 8210ec10-2dca-406c-ac4a-0661d2189954
        example:
            id: 02f1a7db-fca8-4521-b57a-2a375c1ced51
            spec:
                backup_configs:
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                database_name: northwind
                database_users:
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                deletion_protection: true
                extensions:
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                features:
                    some_feature: enabled
                nodes:
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                port: 5432
                postgres_version: "17"
                postgresql_conf:
                    max_connections: 1000
                spock_version: "4"
            tenant_id: 8210ec10-2dca-406c-ac4a-0661d2189954
    Database:
        title: Database
        type: object
        properties:
            created_at:
                type: string
                description: The time that the database was created.
                example: "2025-01-01T01:30:00Z"
                format: date-time
            id:
                type: string
                description: Unique identifier for the database.
                example: 02f1a7db-fca8-4521-b57a-2a375c1ced51
            instances:
                $ref: '#/definitions/Instance'
            spec:
                $ref: '#/definitions/DatabaseSpec'
            status:
                $ref: '#/definitions/DatabaseStatus'
            tenant_id:
                type: string
                description: Unique identifier for the databases's owner.
                example: 8210ec10-2dca-406c-ac4a-0661d2189954
            updated_at:
                type: string
                description: The time that the database was last updated.
                example: "2025-01-01T02:30:00Z"
                format: date-time
        example:
            created_at: "2025-01-01T01:30:00Z"
            id: 02f1a7db-fca8-4521-b57a-2a375c1ced51
            instances:
                created_at: "1979-11-26T06:52:11Z"
                host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                interfaces:
                    - hostname: postgres-n1
                      ipv4_address: 10.1.0.113
                      network_id: l5imrq28sh6s
                      network_type: docker
                      port: 5432
                    - hostname: postgres-n1
                      ipv4_address: 10.1.0.113
                      network_id: l5imrq28sh6s
                      network_type: docker
                      port: 5432
                node_name: n1
                status:
                    patroni_paused: true
                    patroni_state: initializing new cluster
                    pending_restart: false
                    postgres_version: "17.1"
                    read_only: true
                    role: primary
                    spock_version: 4.0.9
                    state: modifying
                    updated_at: "2014-10-05T16:37:36Z"
                updated_at: "1981-04-07T04:09:52Z"
            spec:
                backup_configs:
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                database_name: northwind
                database_users:
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                deletion_protection: true
                extensions:
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                features:
                    some_feature: enabled
                nodes:
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                port: 5432
                postgres_version: "17"
                postgresql_conf:
                    max_connections: 1000
                spock_version: "4"
            status:
                state: error
                updated_at: "2025-01-01T10:30:37Z"
            tenant_id: 8210ec10-2dca-406c-ac4a-0661d2189954
            updated_at: "2025-01-01T02:30:00Z"
        required:
            - id
            - status
            - instances
    DatabaseExtensionSpec:
        title: DatabaseExtensionSpec
        type: object
        properties:
            name:
                type: string
                description: The name of the extension to install in this database.
                example: postgis
            version:
                type: string
                description: The version of the extension to install in this database.
                example: 1.2.3
        example:
            name: postgis
            version: 1.2.3
        required:
            - name
    DatabaseNodeSpec:
        title: DatabaseNodeSpec
        type: object
        properties:
            host_id:
                type: string
                description: The ID of the host that should run this node.
                example: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            instance_id:
                type: string
                description: A unique identifier for the instance that will be created from this node specification.
                example: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            name:
                type: string
                description: The name of the database node.
                example: n1
            port:
                type: integer
                description: The port used by the Postgres database for this node. Overrides the Postgres port set in the DatabaseSpec.
                example: 5432
                format: int64
            postgres_version:
                type: string
                description: The major version of Postgres for this node. Overrides the Postgres version set in the DatabaseSpec.
                example: "17"
                enum:
                    - "16"
                    - "17"
            postgresql_conf:
                type: object
                description: Additional postgresql.conf settings for this particular node. Will be merged with the settings provided by control-plane.
                example:
                    max_connections: 1000
                additionalProperties: true
            read_replicas:
                $ref: '#/definitions/DatabaseReplicaSpec'
        example:
            host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            name: n1
            port: 5432
            postgres_version: "17"
            postgresql_conf:
                max_connections: 1000
            read_replicas:
                host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
        required:
            - name
            - instance_id
            - host_id
    DatabaseReplicaSpec:
        title: DatabaseReplicaSpec
        type: object
        properties:
            host_id:
                type: string
                description: The ID of the host that should run this read replica.
                example: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            instance_id:
                type: string
                description: A unique identifier for the instance that will be created from this replica specification.
                example: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
        example:
            host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
        required:
            - instance_id
            - host_id
    DatabaseSpec:
        title: DatabaseSpec
        type: object
        properties:
            backup_configs:
                type: array
                items:
                    $ref: '#/definitions/BackupConfigSpec'
                description: The backup configurations for this database.
                example:
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
            database_name:
                type: string
                description: The name of the Postgres database.
                example: northwind
            database_users:
                type: array
                items:
                    $ref: '#/definitions/DatabaseUserSpec'
                description: The users to create for this database.
                example:
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
            deletion_protection:
                type: boolean
                description: Prevents deletion when true.
                example: true
            extensions:
                type: array
                items:
                    $ref: '#/definitions/DatabaseExtensionSpec'
                description: The extensions to install for this database.
                example:
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
            features:
                type: object
                description: The feature flags for this database.
                example:
                    some_feature: enabled
                additionalProperties:
                    type: string
                    example: Magni quaerat qui quam id aut velit.
            nodes:
                type: array
                items:
                    $ref: '#/definitions/DatabaseNodeSpec'
                description: The Spock nodes for this database.
                example:
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
            port:
                type: integer
                description: The port used by the Postgres database.
                example: 5432
                format: int64
            postgres_version:
                type: string
                description: The major version of the Postgres database.
                example: "17"
                enum:
                    - "16"
                    - "17"
            postgresql_conf:
                type: object
                description: Additional postgresql.conf settings. Will be merged with the settings provided by control-plane.
                example:
                    max_connections: 1000
                additionalProperties: true
            spock_version:
                type: string
                description: The major version of the Spock extension.
                example: "4"
                enum:
                    - "4"
        example:
            backup_configs:
                - id: default
                  node_names:
                    - n1
                    - n3
                  provider: pgbackrest
                  repositories:
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                  schedules:
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                - id: default
                  node_names:
                    - n1
                    - n3
                  provider: pgbackrest
                  repositories:
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                  schedules:
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                - id: default
                  node_names:
                    - n1
                    - n3
                  provider: pgbackrest
                  repositories:
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                    - azure_account: pgedge-backups
                      azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      azure_endpoint: blob.core.usgovcloudapi.net
                      base_path: /backups
                      gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      gcs_endpoint: localhost
                      id: f6b84a99-5e91-4203-be1e-131fe82e5984
                      retention_full: 2
                      retention_full_type: count
                      s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                      s3_endpoint: s3.us-east-1.amazonaws.com
                      s3_region: us-east-1
                      type: s3
                  schedules:
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
                    - cron_expression: 0 6 * * ?
                      id: daily-full-backup
                      type: full
            database_name: northwind
            database_users:
                - password: secret
                  roles:
                    - application_read_only
                  superuser: true
                  username: admin
                - password: secret
                  roles:
                    - application_read_only
                  superuser: true
                  username: admin
                - password: secret
                  roles:
                    - application_read_only
                  superuser: true
                  username: admin
                - password: secret
                  roles:
                    - application_read_only
                  superuser: true
                  username: admin
            deletion_protection: true
            extensions:
                - name: postgis
                  version: 1.2.3
                - name: postgis
                  version: 1.2.3
                - name: postgis
                  version: 1.2.3
            features:
                some_feature: enabled
            nodes:
                - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                  name: n1
                  port: 5432
                  postgres_version: "17"
                  postgresql_conf:
                    max_connections: 1000
                  read_replicas:
                    host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                    instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                  name: n1
                  port: 5432
                  postgres_version: "17"
                  postgresql_conf:
                    max_connections: 1000
                  read_replicas:
                    host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                    instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                  name: n1
                  port: 5432
                  postgres_version: "17"
                  postgresql_conf:
                    max_connections: 1000
                  read_replicas:
                    host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                    instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                  instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                  name: n1
                  port: 5432
                  postgres_version: "17"
                  postgresql_conf:
                    max_connections: 1000
                  read_replicas:
                    host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                    instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
            port: 5432
            postgres_version: "17"
            postgresql_conf:
                max_connections: 1000
            spock_version: "4"
        required:
            - database_name
            - nodes
    DatabaseStatus:
        title: DatabaseStatus
        type: object
        properties:
            state:
                type: string
                example: available
                enum:
                    - creating
                    - modifying
                    - available
                    - error
            updated_at:
                type: string
                description: The time that the database status was last updated.
                example: "2025-01-01T10:30:37Z"
                format: date-time
        example:
            state: modifying
            updated_at: "2025-01-01T10:30:37Z"
    DatabaseUserSpec:
        title: DatabaseUserSpec
        type: object
        properties:
            password:
                type: string
                description: The password for this database user.
                example: secret
            roles:
                type: array
                items:
                    type: string
                    example: Laudantium et quia commodi.
                description: The roles to assign to this database user.
                example:
                    - application_read_only
            superuser:
                type: boolean
                description: Enables SUPERUSER for this database user when true.
                example: true
            username:
                type: string
                description: The username for this database user.
                example: admin
        example:
            password: secret
            roles:
                - application_read_only
            superuser: true
            username: admin
        required:
            - username
            - password
    Host:
        title: Host
        type: object
        properties:
            cohort:
                type: string
                description: The cohort that this host belongs to
                example: pps1n11hqijn9rbee4cjil453
            config:
                $ref: '#/definitions/HostConfiguration'
            hostname:
                type: string
                description: The hostname of this host.
                example: i-0123456789abcdef.ec2.internal
            id:
                type: string
                description: Unique identifier for the host
                example: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            ipv4_address:
                type: string
                description: The IPv4 address of this host.
                example: 10.24.34.0
                format: ipv4
            status:
                $ref: '#/definitions/HostStatus'
            type:
                type: string
                description: The type of this host
                example: swarm
                enum:
                    - swarm
                    - systemd
        example:
            cohort: pps1n11hqijn9rbee4cjil453
            config:
                traefik_enabled: true
                vector_enabled: true
            hostname: i-0123456789abcdef.ec2.internal
            id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            ipv4_address: 10.24.34.0
            status:
                state: available
            type: systemd
        required:
            - id
            - status
            - hostname
            - ipv4_address
    HostConfiguration:
        title: HostConfiguration
        type: object
        properties:
            traefik_enabled:
                type: boolean
                description: Enables the Treafik load balancer
                example: false
            vector_enabled:
                type: boolean
                description: Enables the Vector service for metrics and log collection
                example: true
        example:
            traefik_enabled: false
            vector_enabled: true
    HostStatus:
        title: HostStatus
        type: object
        properties:
            state:
                type: string
                example: available
                enum:
                    - available
                    - unreachable
                    - error
        example:
            state: available
        required:
            - state
    Instance:
        title: Instance
        type: object
        properties:
            created_at:
                type: string
                description: The time that the instance was created.
                example: "1981-08-03T21:17:54Z"
                format: date-time
            host_id:
                type: string
                description: The ID of the host this instance is running on.
                example: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            id:
                type: string
                description: Unique identifier for the instance.
                example: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            interfaces:
                type: array
                items:
                    $ref: '#/definitions/InstanceInterface'
                description: All interfaces that this instance serves on.
                example:
                    - hostname: postgres-n1
                      ipv4_address: 10.1.0.113
                      network_id: l5imrq28sh6s
                      network_type: docker
                      port: 5432
                    - hostname: postgres-n1
                      ipv4_address: 10.1.0.113
                      network_id: l5imrq28sh6s
                      network_type: docker
                      port: 5432
            node_name:
                type: string
                description: The Spock node name for this instance.
                example: n1
            status:
                $ref: '#/definitions/InstanceStatus'
            updated_at:
                type: string
                description: The time that the instance was last updated.
                example: "2009-09-01T05:13:11Z"
                format: date-time
        example:
            created_at: "2004-11-09T18:36:56Z"
            host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
            id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
            interfaces:
                - hostname: postgres-n1
                  ipv4_address: 10.1.0.113
                  network_id: l5imrq28sh6s
                  network_type: docker
                  port: 5432
                - hostname: postgres-n1
                  ipv4_address: 10.1.0.113
                  network_id: l5imrq28sh6s
                  network_type: docker
                  port: 5432
                - hostname: postgres-n1
                  ipv4_address: 10.1.0.113
                  network_id: l5imrq28sh6s
                  network_type: docker
                  port: 5432
                - hostname: postgres-n1
                  ipv4_address: 10.1.0.113
                  network_id: l5imrq28sh6s
                  network_type: docker
                  port: 5432
            node_name: n1
            status:
                patroni_paused: true
                patroni_state: initializing new cluster
                pending_restart: false
                postgres_version: "17.1"
                read_only: true
                role: primary
                spock_version: 4.0.9
                state: modifying
                updated_at: "2014-10-05T16:37:36Z"
            updated_at: "1978-08-17T11:52:12Z"
        required:
            - id
            - status
    InstanceInterface:
        title: InstanceInterface
        type: object
        properties:
            hostname:
                type: string
                description: The hostname of the instance on this interface.
                example: postgres-n1
            ipv4_address:
                type: string
                description: The IPv4 address of the instance on this interface.
                example: 10.1.0.113
                format: ipv4
            network_id:
                type: string
                description: The unique identifier of the network for this interface.
                example: l5imrq28sh6s
            network_type:
                type: string
                description: The type of network for this interface.
                example: docker
                enum:
                    - docker
                    - host
            port:
                type: integer
                description: The Postgres port for the instance on this interface.
                example: 5432
                format: int64
        example:
            hostname: postgres-n1
            ipv4_address: 10.1.0.113
            network_id: l5imrq28sh6s
            network_type: docker
            port: 5432
    InstanceStatus:
        title: InstanceStatus
        type: object
        properties:
            patroni_paused:
                type: boolean
                description: True if Patroni has been paused for this instance.
                example: true
            patroni_state:
                type: string
                example: custom bootstrap failed
                enum:
                    - stopping
                    - stopped
                    - stop failed
                    - crashed
                    - running
                    - starting
                    - start failed
                    - restarting
                    - restart failed
                    - initializing new cluster
                    - initdb failed
                    - running custom bootstrap script
                    - custom bootstrap failed
                    - creating replica
                    - unknown
            pending_restart:
                type: boolean
                description: True if this instance is pending to be restarted from a configuration change.
                example: true
            postgres_version:
                type: string
                description: The version of Postgres for this instance.
                example: "17.1"
            read_only:
                type: boolean
                description: True if this instance is in read-only mode.
                example: false
            role:
                type: string
                example: replica
                enum:
                    - replica
                    - primary
            spock_version:
                type: string
                description: The version of Spock for this instance.
                example: 4.0.9
            state:
                type: string
                example: creating
                enum:
                    - creating
                    - modifying
                    - backing_up
                    - available
                    - error
            updated_at:
                type: string
                description: The time that the instance status was last updated.
                example: "1998-03-09T10:30:37Z"
                format: date-time
        example:
            patroni_paused: true
            patroni_state: stopped
            pending_restart: false
            postgres_version: "17.1"
            read_only: true
            role: primary
            spock_version: 4.0.9
            state: modifying
            updated_at: "1986-12-19T00:29:43Z"
        required:
            - state
    UpdateDatabaseRequest:
        title: UpdateDatabaseRequest
        type: object
        properties:
            spec:
                $ref: '#/definitions/DatabaseSpec'
        example:
            spec:
                backup_configs:
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                    - id: default
                      node_names:
                        - n1
                        - n3
                      provider: pgbackrest
                      repositories:
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                        - azure_account: pgedge-backups
                          azure_container: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          azure_endpoint: blob.core.usgovcloudapi.net
                          base_path: /backups
                          gcs_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          gcs_endpoint: localhost
                          id: f6b84a99-5e91-4203-be1e-131fe82e5984
                          retention_full: 2
                          retention_full_type: count
                          s3_bucket: pgedge-backups-9f81786f-373b-4ff2-afee-e054a06a96f1
                          s3_endpoint: s3.us-east-1.amazonaws.com
                          s3_region: us-east-1
                          type: s3
                      schedules:
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                        - cron_expression: 0 6 * * ?
                          id: daily-full-backup
                          type: full
                database_name: northwind
                database_users:
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                    - password: secret
                      roles:
                        - application_read_only
                      superuser: true
                      username: admin
                deletion_protection: true
                extensions:
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                    - name: postgis
                      version: 1.2.3
                features:
                    some_feature: enabled
                nodes:
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                    - host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                      instance_id: a67cbb36-c3c3-49c9-8aac-f4a0438a883d
                      name: n1
                      port: 5432
                      postgres_version: "17"
                      postgresql_conf:
                        max_connections: 1000
                      read_replicas:
                        host_id: de3b1388-1f0c-42f1-a86c-59ab72f255ec
                        instance_id: 5ec51c55-0921-445e-9d5b-32f5fb5dfbae
                port: 5432
                postgres_version: "17"
                postgresql_conf:
                    max_connections: 1000
                spock_version: "4"
